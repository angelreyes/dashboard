<!DOCTYPE html>
<html>
	<head>
		<title>View.html</title>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
		<script type="text/javascript" src="https://www.google.com/jsapi"></script>
		<script src="charts.js"></script>
	</head>
	<body>

		<div id="toolbar">
			<table width="100%">
				<tr style="background-color:#27ae60;">
					<td colspan="2" align="center">
						<h2>Interactive Dashboard Example</h2>
					</td>
				</tr>
				<tr style="background-color:#33ce75;">
					<td align="left">
						<select id="months">
							<option value="last12">Last 12 Months</option>
							<option value="last6">Last 6 Months</option>
							<option value="last3">Last 3 Months</option>
							<option value="previousYear">Previous Year</option>
						</select>
					</td>
					<td align="right">
						<button id="refresh">Refresh</button>
					</td>
				</tr>
			</table>
		</div>
		<div id="widgets">
			<div id="w1" class="widget">
				<div id="control1" class="filter" style="display:none"></div>
				<select class="widgetType" id="wb1">
					<option value="column">Column</option>
					<option value="line">Line</option>
				</select>
				<div id="dashboard1" class="dash">
					<div id="chart1" class="kpi"  style="width: 100%; height: 500px;">
						<img src="images/spinner.gif" class="spinner" />
					</div>
				</div>
			</div>
			<div id="w2" class="widget">
				<div id="control2" class="filter" style="display:none"></div>
				<select class="widgetType" id="wb1">
					<option value="column">Column</option>
					<option value="line">Line</option>
				</select>
				<div id="dashboard2" class="dash">
					<div id="chart2" class="kpi" style="width: 100%; height: 500px;">
						<img src="images/spinner.gif" class="spinner" />
					</div>
				</div>
			</div>
		</div>

		<script type="text/javascript">
			google.load("visualization", "1", {packages:["corechart","controls"]});
		</script>

		<script type="text/javascript">
			$(document).ready(function (){

					// initialization
					$( "#widgets" )
						.find( ".kpi" )
						.each(function() {
								widget = $(this).parent().parent();
								element = $(this).get(0);
								doOpts(element, "control", $(widget).find(".filter").get(0));
								doOpts(element, "dash", $(widget).find(".dash").get(0));
								doOpts(element, "type", "column");
								doOpts(element, "filter", getMonths("last12"));
								doChart(element, doOpts(element));
							});

					// change time frame
					$('#months').change(function(e){
						that = $(this);
						$( "#widgets" )
							.find( ".kpi" )
							.each(function() {
									element = $(this).get(0)
									doOpts(element, "filter", getMonths( $(that).val() ));
									doChart(element, doOpts(element));
								});
						e.preventDefault();
					});

					// change chart type
					$('.widgetType').change(function(e){
						var kpi = $(this).parent(".widget").find(".kpi").get(0);
						doOpts(kpi, "type", $(this).val() );
						doChart(kpi, doOpts(kpi));
						e.preventDefault();
					});

			});
		</script>

	</body>
</html>
